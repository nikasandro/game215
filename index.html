<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Phaser Dino Game</title>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.js"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }

    #ui {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 10;
    }

    #nightToggle, #soundToggle {
      margin-right: 10px;
      padding: 5px 10px;
      font-size: 18px;
      background: #eee;
      border-radius: 8px;
      cursor: pointer;
    }

    #gameContainer.night {
      background: #111 !important;
    }
  </style>
</head>
<body>
  <div id="ui">
    <button id="nightToggle">🌙</button>
    <button id="soundToggle">🔊</button>
  </div>
  <div id="gameContainer"></div>

  <script>
    let soundOn = true;
    let isNight = false;

    const config = {
      type: Phaser.AUTO,
      width: window.innerWidth,
      height: window.innerHeight,
      parent: 'gameContainer',
      physics: {
        default: 'arcade',
        arcade: {
          gravity: { y: 600 },
          debug: false
        }
      },
      scene: {
        preload,
        create,
        update
      }
    };

    const game = new Phaser.Game(config);

    let dino, cursors, score = 0, highScore = 0;
    let scoreText, highScoreText;
    let obstacles, clouds;
    let gameOver = false;
    let speed = 200;
    let jumpSound, gameOverSound;
    let paused = false;

    function preload() {
      this.load.image('dino', 'dinosaur.png');
      this.load.image('cactus', 'cactus.png');
      this.load.image('cloud', 'cloud.png');
      this.load.audio('jumpSound', 'https://www.soundjay.com/button/beep-07.wav');
      this.load.audio('gameOverSound', 'https://www.soundjay.com/button/beep-10.wav');
    }

    function create() {
      highScore = localStorage.getItem("dinoHighScore") || 0;

      this.cameras.main.setBackgroundColor('#fff');
      jumpSound = this.sound.add('jumpSound');
      gameOverSound = this.sound.add('gameOverSound');

      clouds = this.add.group();
      this.time.addEvent({
        delay: 3000,
        loop: true,
        callback: () => {
          const cloud = this.add.image(config.width + 100, Phaser.Math.Between(20, 100), 'cloud').setAlpha(0.5);
          this.physics.add.existing(cloud);
          cloud.body.setVelocityX(-30);
          clouds.add(cloud);
        }
      });

      dino = this.physics.add.sprite(100, config.height - 100, 'dino').setScale(1).setCollideWorldBounds(true);

      obstacles = this.physics.add.group();

      this.time.addEvent({
        delay: 1500,
        loop: true,
        callback: () => {
          if (!gameOver && !paused) {
            const obs = obstacles.create(config.width + 50, config.height - 60, 'cactus');
            obs.setVelocityX(-speed);
            obs.setImmovable(true);
            obs.setSize(30, 50);
          }
        }
      });

      cursors = this.input.keyboard.createCursorKeys();
      this.input.keyboard.on('keydown-P', () => paused = !paused);

      this.input.keyboard.on('keydown-SPACE', jump);
      this.input.on('pointerdown', jump);

      scoreText = this.add.text(config.width - 200, 20, 'Score: 0', { fontSize: '20px', fill: '#333' });
      highScoreText = this.add.text(config.width - 200, 50, `High Score: ${highScore}`, { fontSize: '20px', fill: '#333' });

      this.physics.add.collider(dino, obstacles, () => {
        if (!gameOver) {
          gameOver = true;
          if (soundOn) gameOverSound.play();
          this.add.text(config.width / 2, config.height / 2, 'Game Over!\nPress R to Restart', {
            fontSize: '40px',
            color: 'red',
            align: 'center'
          }).setOrigin(0.5);

          if (score > highScore) {
            highScore = score;
            localStorage.setItem("dinoHighScore", highScore);
          }
        }
      });

      this.input.keyboard.on('keydown-R', () => {
        location.reload();
      });

      this.time.addEvent({
        delay: 100,
        loop: true,
        callback: () => {
          if (!gameOver && !paused) {
            score++;
            scoreText.setText(`Score: ${score}`);
            if (score % 100 === 0) speed += 10;
          }
        }
      });
    }

    function update() {
      if (paused || gameOver) return;

      obstacles.getChildren().forEach(obs => {
        if (obs.x < -50) obs.destroy();
      });

      clouds.getChildren().forEach(cloud => {
        if (cloud.x < -100) cloud.destroy();
      });
    }

    function jump() {
      if (!gameOver && dino.body.touching.down) {
        dino.setVelocityY(-350);
        if (soundOn) jumpSound.play();
      }
    }

    // UI toggles
    document.getElementById('nightToggle').onclick = () => {
      isNight = !isNight;
      document.getElementById('gameContainer').classList.toggle('night', isNight);
      game.scene.scenes[0].cameras.main.setBackgroundColor(isNight ? '#222' : '#fff');
      document.getElementById('nightToggle').textContent = isNight ? '☀️' : '🌙';
    };

    document.getElementById('soundToggle').onclick = () => {
      soundOn = !soundOn;
      document.getElementById('soundToggle').textContent = soundOn ? '🔊' : '🔇';
    };
  </script>
</body>
</html>

